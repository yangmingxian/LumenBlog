+++
title = "åŸºäºåˆ†è¾¨ç‡ç¼©æ”¾çš„é«˜æ•ˆå›¾åƒç”Ÿæˆæ¨¡å‹"
date = "2024-12-04 14:56:00 +0800"
tags = ["AI"]
categories = ["technology"]
slug = "Efficient image generation model based on resolution scaling"
indent = false
dropCap = false
# katex = true
math = true
+++


![var](FT.png)

### å‰è¨€

> *èµ·å› æ˜¯æœ‹å‹ç»™æˆ‘å‘äº†å­—èŠ‚çš„å“ªä¸ªæ–°ç“œï¼Œæˆ‘å¯¹åƒç“œå®Œå…¨æ²¡æœ‰å…´è¶£ï¼Œåå€’æ˜¯ä½œè€…çš„è¿™ä¸ªæ–°æ¨¡å‹è¯´æ˜¯å·²ç»è¶…è¶Šäº†ç°æœ‰çš„æ‰©æ•£æ¨¡å‹ã€‚*
 
è¿˜è®°å¾—å½“æ—¶æ‰©æ•£æ¨¡å‹åˆšå‡ºæ¥çš„æ—¶å€™ï¼Œæˆ‘æ„Ÿè§‰å¾ˆç¥å¥‡ï¼Œå› ä¸ºå½“æ—¶è¿˜æ˜¯ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œ(GAN)çš„å¤©ä¸‹ï¼Œæ‰©æ•£æ¨¡å‹ç”Ÿæˆçš„åŸç†å±äºæ˜¯å¦èµ·ç‚‰ç¶ï¼Œæ­£åå‘æ·»åŠ å™ªå£°çš„è§’åº¦å®åœ¨æ˜¯è®©äººæ„Ÿåˆ°å¾ˆæ–°å¥‡ã€‚ä»äººç±»ç”»ç”»çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç§æ€è·¯è¿‡äºæ¸…å¥‡ï¼Œä¸è¿‡ä¹Ÿç¡®å®æ˜¯å¾—åˆ°äº†æœªæ¥ï¼Œä¹Ÿå°±æ˜¯è¿™å‡ å¹´çš„éªŒè¯ï¼Œå„ç§AIGCå±‚å‡ºä¸ç©·ã€‚

é‚£ä¹ˆæˆ‘æƒ³çœ‹çœ‹è¿™å›æœ‰å¯èƒ½æ‰“ç ´ç»å¯¹é¢†å…ˆåœ°ä½çš„æ¨¡å‹çš„è®ºæ–‡åˆæ˜¯ä»€ä¹ˆä¸ªæ€è·¯ã€‚æ›´ä½•å†µè¿™è¿˜æ˜¯å®ä¹ ç”Ÿçš„ä¸»è¦è´¡çŒ®ï¼Œå¥½å¥‡ç”šäºå´‡æ‹œã€‚

è¿™é‡Œæ˜¯ä½œè€…å¼€æºçš„ä»“åº“åœ°å€: [**VAR Github**](https://github.com/FoundationVision/VAR)

### æ¨¡å‹ç®€ä»‹

è¿™ä¸ªå›¾åƒç”Ÿæˆæ¨¡å‹ **Visual AutoRegressive (VAR)**ï¼Œä¸å†æŒ‰ç…§ä¼ ç»Ÿçš„åƒç´ æˆ–ä»¤ç‰Œçš„æ …æ ¼æ‰«æé¡ºåºç”Ÿæˆï¼Œè€Œæ˜¯é‡‡å–ä»ç²—åˆ°ç»†çš„å¤šå°ºåº¦**ä¸‹ä¸€åˆ†è¾¨ç‡é¢„æµ‹**æ–¹æ³•ã€‚æ¯ä¸€é˜¶æ®µï¼ŒVARä»¥æ›´é«˜åˆ†è¾¨ç‡ç”Ÿæˆå›¾åƒç‰¹å¾ã€‚

æˆ‘ä¸å¤ªå–œæ¬¢ä»€ä¹ˆé«˜æ·±çš„ä¸“ä¸šåè¯è§£é‡Šï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­å¯¹æ¯”ä¸€ä¸‹ï¼š  
- ä¼ ç»Ÿçš„åƒç´ æˆ–ä»¤ç‰Œæ …æ ¼æ‰«ææ–¹å¼å°±åƒä¸€ä¸ªç”»å®¶ä»å·¦ä¸Šè§’å¼€å§‹é€ä¸ªç”»ç½‘æ ¼ï¼Œæ¯æ¬¡åªå®Œæˆä¸€ä¸ªå°æ ¼å­çš„å†…å®¹ã€‚ç”»å®Œå·¦ä¸Šè§’çš„ç½‘æ ¼åï¼Œä»–ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªï¼Œç›´åˆ°æ•´å¼ ç”»å¸ƒå¡«æ»¡ã€‚è¿™ç§æ–¹æ³•å¯èƒ½å®¹æ˜“ç¼ºä¹æ•´ä½“æ„Ÿã€‚
- è€ŒVARçš„â€œä»ç²—åˆ°ç»†â€å¤šå°ºåº¦é¢„æµ‹æ–¹æ³•æ˜¯ï¼Œå®ƒå…ˆç”Ÿæˆä½åˆ†è¾¨ç‡çš„æ•´ä½“è½®å»“ï¼ˆæ¯”å¦‚32Ã—32ï¼‰ã€‚
å†é€æ­¥æå‡åˆ†è¾¨ç‡ï¼Œåœ¨æ›´é«˜åˆ†è¾¨ç‡çš„åŸºç¡€ä¸Šå¡«å……æ›´å¤šç»†èŠ‚ï¼ˆå¦‚64Ã—64ã€128Ã—128ï¼Œç›´åˆ°ç›®æ ‡åˆ†è¾¨ç‡ï¼‰ã€‚è¿™ç§æ–¹æ³•åœ¨æˆ‘çœ‹æ¥æ›´ç¬¦åˆäººç±»çš„è§†è§‰ä¹ æƒ¯ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯ä»æ•´ä½“åˆ°å±€éƒ¨çš„ï¼Œä»ç²—ç•¥åˆ°ç²¾ç»†ï¼Œä¿è¯äº†ç”»é¢ä¸€å¼€å§‹å°±æœ‰å…¨å±€æ„Ÿï¼Œå¹¶ä¸”ç»†èŠ‚é€æ­¥è¢«å¡«å……ã€‚

### ä¸»è¦è´¡çŒ®

ç›¸ä¿¡å…¶ä»–æ–‡ç« éƒ½å·²ç»å†™çš„å¾ˆå¤šäº†ï¼Œå¦‚æœä½ ä¸æƒ³çœ‹é‚£äº›å¤æ‚ä¸“ä¸šçš„è¯æ±‡å’Œåˆ†æã€‚æˆ‘è¿™é‡Œç”¨æˆ‘çš„å¤§ç™½è¯æ¦‚æ‹¬ä¸€ä¸‹ã€‚å…¶å®æ‰€æœ‰çš„è´¡çŒ®éƒ½æ˜¯å› ä¸ºè¿™ç§æ€è·¯æ”¹å˜å¸¦æ¥çš„ã€‚

1. æ€§èƒ½æå‡ã€‚æ›´å¿«äº†ï¼Œä¹‹å‰çš„æ‰©æ•£æ¨¡å‹çš„é€æ­¥è¿‡ç¨‹æ˜¯å¯¹å›¾å½¢å»é©¬èµ›å…‹åŒ–ï¼Œæ¯ä¸ªé€æ­¥è¿‡ç¨‹éƒ½æ˜¯å¯¹æ•´ä¸ªå›¾åƒæœ‰å¼€é”€çš„ã€‚ä½†æ˜¯æ–°çš„VARä½¿ç”¨çš„æ˜¯ä»ä½åˆ†è¾¨ç‡åˆ°é«˜åˆ†è¾¨ç‡çš„é€æ­¥è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å‡å°‘äº†å¾ˆå¤šæš´åŠ›è®¡ç®—çš„å¼€é”€ã€‚æ‰€ä»¥æ¨¡å‹ç”Ÿæˆçš„æ›´å¿«äº†ï¼ˆå¤§çº¦æ˜¯æ‰©æ•£æ¨¡å‹çš„å‡ åå€ï¼‰ã€‚
2. æ‰©å±•æ€§ä¼˜åŠ¿ã€‚
   - å¯¹äºä¸åŒä»»åŠ¡ç±»å‹çš„æ‰©å±•ï¼šVARæ— éœ€é¢å¤–è®­ç»ƒä¾¿èƒ½åœ¨å›¾åƒè¡¥å…¨ï¼ˆin-paintingï¼‰ã€æ‰©å±•ï¼ˆout-paintingï¼‰å’Œç¼–è¾‘ç­‰ä»»åŠ¡ä¸­å±•ç¤ºä¼˜ç§€è¡¨ç°ã€‚ä¸éœ€è¦å†å•ç‹¬è®­ç»ƒã€‚å› ä¸ºå®ƒæœ¬èº«å°±æ˜¯åœ¨åšç±»ä¼¼äºè¡¥å…¨å’Œç»†åŒ–çš„å·¥ä½œã€‚
   - å¯¹äºå›¾åƒè§„æ¨¡çš„å¢å¤§ï¼šVARæ¨¡å‹çš„æ‰©å±•ç¬¦åˆç±»ä¼¼è¯­è¨€æ¨¡å‹çš„å¹‚å¾‹ç¼©æ”¾å®šå¾‹ï¼Œè§„æ¨¡æå‡æ—¶æ€§èƒ½å‡ ä¹çº¿æ€§å¢å¼ºã€‚é€šä¿—ç†è§£å°±æ˜¯ï¼šè¿™ä¸ªæ¨¡å‹å’Œå¤§å¤šæ•°ç°ä»£AIä¸€æ ·ï¼Œè¶Šå¤šçš„æ•°æ®å’Œè®¡ç®—èµ„æºå–‚ç»™å®ƒï¼Œç”Ÿæˆçš„å›¾åƒè´¨é‡å°±è¶Šé«˜ï¼Œè€Œä¸”è¿™æå‡åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯çº¿æ€§ä¸”è§„å¾‹çš„ã€‚


### æŠ€æœ¯ç»†èŠ‚
æˆ‘çœ‹ç€ä¹Ÿè´¹åŠ²ï¼Œå¯ä»¥ä¸çœ‹ï¼Œä½†æ˜¯æˆ‘å†™äº†ã€‚~~è¦ä¸ç„¶æ–‡ç« æ˜¾å¾—ä¸å¤Ÿä¸“ä¸šï¼ˆè¿™å¥è¯æ ‡è®°è¦åˆ æ‰ï¼‰~~ã€‚èƒ½çœ‹æ‡‚çš„ä¹Ÿä¸è¦åœ¨æˆ‘è¿™é‡Œçœ‹ï¼Œå»çœ‹åŸæ–‡ï¼

#### å¤šå°ºåº¦é‡åŒ–ç¼–ç å™¨ï¼ˆVQVAEï¼‰
VARæ¨¡å‹çš„è¾“å…¥å¤„ç†ç”±ä¸€ä¸ªæ”¹è¿›ç‰ˆçš„VQVAEå®Œæˆï¼Œè¯¥æ¨¡å—å°†å›¾åƒè½¬æ¢ä¸ºå¤šå°ºåº¦çš„ç¦»æ•£è¡¨ç¤ºï¼ˆToken Mapï¼‰

##### æ ¸å¿ƒæ­¥éª¤

1. **å›¾åƒç¼–ç **     
   - åŸå§‹å›¾åƒ $\operatorname{im}$ ç»è¿‡ç¼–ç å™¨ $E(\cdot)$ ï¼Œè¢«æ˜ å°„ä¸ºè¿ç»­çš„ç‰¹å¾å›¾ $f \in \mathbb{R}^{h \times w \times C}$ ã€‚  
     
   - ç¼–ç å™¨çš„ç»“æ„é‡‡ç”¨å·ç§¯ç½‘ç»œæå–å¤šå°ºåº¦ç‰¹å¾ã€‚   

```python
# ç¼–ç é˜¶æ®µä¼ªä»£ç 
def multi_scale_encoding(image):
    f = encoder(image)  # æå–ç‰¹å¾å›¾
    R = []  # å­˜å‚¨å¤šåˆ†è¾¨ç‡ä»¤ç‰Œå›¾
    for k in range(1, K+1):
        r_k = quantize(interpolate(f, h_k, w_k))  # é‡åŒ–å½“å‰åˆ†è¾¨ç‡
        R.append(r_k)
        z_k = lookup_codebook(r_k)
        z_k = upsample(z_k, h, w)
        f = f - convolution(z_k)  # æ®‹å·®
    return R
```

2. **å¤šå°ºåº¦é‡åŒ–**  
   - ç‰¹å¾å›¾ $f$ è¢«é€æ­¥ä¸‹é‡‡æ ·ï¼Œç”Ÿæˆ $K$ ä¸ªä¸åŒåˆ†è¾¨ç‡çš„ç‰¹å¾å›¾ $f_k$ã€‚ 
   - æ¯ä¸ª $f_k$ ç»çŸ¢é‡é‡åŒ–æ¨¡å†³ $Q(\cdot)$ ï¼Œæ˜ å°„ä¸ºç¦»æ•£çš„ä»¤ç‰Œå›¾ $r_k \in[V]^{h_k \times w_k}$ ï¼Œå…¶ä¸­ $V$ æ˜¯å…±äº«çš„ä»£ç è¡¨ (Codebook) å¤§å°ã€‚  
   - æ®‹å·®è®¾è®¡ï¼šä»¤ $f$å‡å»ç”±é‡åŒ–ç”Ÿæˆçš„é‡å»ºå€¼ $Ï•_k(z_k)$ï¼ˆä½¿ç”¨å·ç§¯ç½‘ç»œå¤„ç†ï¼‰ï¼Œå‰©ä½™ä¿¡æ¯ä¼ é€’åˆ°ä¸‹ä¸€åˆ†è¾¨ç‡å±‚ã€‚

3. **è§£ç å™¨é‡å»º**  
   - å¤šå°ºåº¦ä»¤ç‰Œå›¾ {$r_1, r_2, \ldots, r_K$} ç»è§£ç å™¨ $D(\cdot)$ é‡å»ºä¸ºæœ€ç»ˆå›¾åƒ $\mathrm{im} ã€‚$

```python
# é‡å»ºé˜¶æ®µä¼ªä»£ç 
def multi_scale_decoding(R):
    f_hat = 0  # é‡å»ºçš„ç‰¹å¾å›¾åˆå§‹åŒ–
    for r_k in R:
        z_k = lookup_codebook(r_k)
        z_k = upsample(z_k, h, w)
        f_hat += convolution(z_k)
    return decoder(f_hat)  # ç”Ÿæˆå›¾åƒ
```

##### é‡åŒ–å…¬å¼
   - ä»¤ $Z \in \mathbb{R}^{V \times C}$ ä¸ºä»£ç è¡¨ã€‚
   - æ¯ä¸ªç‰¹å¾å‘é‡ $f^{(i, j)}$ è¢«é‡åŒ–ä¸ºä»£ç è¡¨ä¸­æœ€è¿‘çš„å‘é‡:

$$
q(i, j)=\arg \min _{v \in[V]}\left\|Z[v]-f^{(i, j)}\right\|_2^2
$$

##### è®­ç»ƒç›®æ ‡

- ç»¼åˆæŸå¤±å‡½æ•°:
    $$
    L=\|\mathrm{im}-\mathrm{im}\|_2^2+\|f-\hat{f}\|_2^2+\lambda_P L_P(\hat{\mathrm{im}})+\lambda_G L_G(\hat{\mathrm{im}})
    $$
    å…¶ä¸­ï¼š
    - $L_P$ï¼šæ„ŸçŸ¥æŸå¤±ï¼ˆç±»ä¼¼äºLPIPSï¼‰ã€‚
    - $L_G$ï¼šåˆ¤åˆ«å™¨æŸå¤±ï¼ˆç±»ä¼¼äºStyleGANä¸­çš„å¯¹æŠ—æŸå¤±ï¼‰ã€‚

#### é€æ­¥åˆ†è¾¨ç‡é¢„æµ‹ç”Ÿæˆæµç¨‹
VARå¼•å…¥äº†ä¸€ç§æ–°çš„è‡ªå›å½’ç”ŸæˆèŒƒå¼ï¼Œæ¯æ¬¡ç”Ÿæˆå®Œæ•´çš„ä»¤ç‰Œå›¾ï¼ˆToken Mapï¼‰ï¼Œè€Œä¸æ˜¯å•ä¸ªä»¤ç‰Œã€‚

**ç”Ÿæˆè¿‡ç¨‹**
  1. åˆå§‹è¾“å…¥
     - ä»¤$r_1$ä¸ºæœ€ç²—åˆ†è¾¨ç‡çš„ä»¤ç‰Œå›¾ï¼ˆæ¯”å¦‚1Ã—1ï¼‰
     - æ¡ä»¶ä¿¡æ¯ï¼ˆå¦‚ç±»æ ‡ï¼‰ç”¨ä½œèµ·å§‹ä»¤ç‰Œ $[S]$ã€‚

  2. é€æ­¥ç”Ÿæˆæ›´é«˜åˆ†è¾¨ç‡
     - ä»$r_1$å¼€å§‹ï¼Œé€æ­¥é¢„æµ‹ $r_2,...,r_K$ï¼Œç›´åˆ°è¾¾åˆ°ç›®æ ‡åˆ†è¾¨ç‡ã€‚
     - æ¯ä¸€æ­¥çš„ç”Ÿæˆé€šè¿‡Transformerå®Œæˆï¼Œå…¬å¼ä¸º:

$$p\left(r_1, r_2, \ldots, r_K\right)=\prod_{k=1}^K p\left(r_k \mid r_1, \ldots, r_{k-1}\right)$$

  3. å¹¶è¡Œä»¤ç‰Œç”Ÿæˆ
     - åœ¨æ¯ä¸€é˜¶æ®µï¼Œæ‰€æœ‰ä»¤ç‰Œ $r_k$ å†…çš„å…ƒç´ æ˜¯åŒæ—¶ç”Ÿæˆçš„ï¼Œè€Œä¸æ˜¯é€ä¸ªç”Ÿæˆã€‚

  4. æ³¨æ„åŠ›æ©ç 
     - ä½¿ç”¨åˆ†å—æ©ç ä¿è¯ç¬¬ $k$ å±‚ä»¤ç‰Œå›¾åªä¾èµ–äº $râ‰¤k$ã€‚


#### Transformeræ¶æ„
ç”¨äºâ€œä¸‹ä¸€åˆ†è¾¨ç‡é¢„æµ‹â€çš„æ¨¡å‹æ˜¯ä¸€ä¸ªæ ‡å‡†çš„è§£ç å™¨å¼Transformer

**ä¸»è¦ç»„ä»¶ï¼š**
1. è¾“å…¥åµŒå…¥ï¼š
   - å°†ä»¤ç‰Œå›¾ $r_k$ çš„æ¯ä¸ªä»¤ç‰Œé€šè¿‡åµŒå…¥å±‚æ˜ å°„ä¸ºé«˜ç»´å‘é‡ã€‚
   - æ¯ä¸ªåˆ†è¾¨ç‡çš„ä»¤ç‰Œå›¾é…å¤‡ç‰¹å®šçš„ä½ç½®åµŒå…¥ï¼ˆPosition Embeddingï¼‰ï¼Œå¸®åŠ©Transformerè¯†åˆ«ç©ºé—´å…³ç³»ã€‚
2. è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼š
   - æ¯ä¸ªTransformerå±‚ä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œè®¡ç®—ä»¤ç‰Œä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼š
$$\operatorname{Attention}(Q, K, V)=\operatorname{Softmax}\left(\frac{Q K^T}{\sqrt{d_k}}\right) V$$
    å…¶ä¸­ $Q$,$K$,$V$ åˆ†åˆ«æ˜¯æŸ¥è¯¢ã€é”®å’Œå€¼å‘é‡ã€‚
3. å‰é¦ˆç½‘ç»œï¼ˆFeed-Forward Networkï¼‰ï¼š
   - çº¿æ€§å±‚å’Œæ¿€æ´»å‡½æ•°çš„å †å ï¼Œç”¨äºéçº¿æ€§å˜æ¢ã€‚
4. å±‚å½’ä¸€åŒ–ï¼ˆLayer Normalizationï¼‰ï¼š
   - ä½¿ç”¨äº†ä¸€ç§æ”¹è¿›çš„è‡ªé€‚åº”å½’ä¸€åŒ–ï¼ˆAdaptive Layer Normalization, AdaLNï¼‰ï¼Œé€‚é…ä¸åŒçš„åˆ†è¾¨ç‡è¾“å…¥ã€‚


#### ç”Ÿæˆç»†èŠ‚å’Œå¤æ‚åº¦ä¼˜åŒ–
1. Top-Ké‡‡æ ·ï¼š
   - åœ¨æ¨ç†æ—¶ï¼Œåªä»æ¦‚ç‡æœ€é«˜çš„Kä¸ªå€™é€‰é¡¹ä¸­é‡‡æ ·ï¼Œé¿å…ä½æ¦‚ç‡é€‰é¡¹å¯¼è‡´çš„ç”Ÿæˆé”™è¯¯ã€‚
2. åˆ†è¾¨ç‡é€æ­¥æå‡ï¼š
   - æ¯ä¸€çº§ç”Ÿæˆçš„å¤æ‚åº¦ä¸º $O(n_k^4)$ å…¶ä¸­ $n_k$ æ˜¯å½“å‰åˆ†è¾¨ç‡çš„å¤§å°ã€‚
   - æ•´ä½“å¤æ‚åº¦ä¸º $O(n^4)$ ï¼Œè¿œä½äºä¼ ç»Ÿè‡ªå›å½’æ–¹æ³•çš„ $O(n^6)$ ã€‚

### æœ¬åœ°éƒ¨ç½²è¿è¡Œ

1. ä½¿ç”¨condaç¯å¢ƒ pythonç‰ˆæœ¬ä¸º3.10.x 
```conda create -n var python==3.10```

2. é€‰æ‹©æ­£ç¡®çš„ç‰ˆæœ¬å®‰è£…pytorch  
```pip install torch>=2.0.0```

1. æ ¹æ®ä»“åº“çš„éœ€æ±‚æ¸…å•æ–‡ä»¶å®‰è£…å…¶ä»–åŒ…  
```pip install -r requirements.txt```

1. ä¸‹è½½é¢„è®­ç»ƒçš„æƒé‡[vae_ch160v4096z32.pth](https://huggingface.co/FoundationVision/var/resolve/main/vae_ch160v4096z32.pth)  
æ”¾åˆ°é¡¹ç›®ç›®å½•ä¸‹
2. ä½¿ç”¨jupyterè¿è¡Œdemo_sample.ipynb  
```jupytre lab```  
*å¦‚æœNumpyæŠ¥é”™ï¼Œè®°å¾—ä½¿ç”¨Numpy 1.xç‰ˆæœ¬*



### Result

|   model    | reso. |   FID    | rel. cost | #params | HF weightsğŸ¤—                                                                        |
|:----------:|:-----:|:--------:|:---------:|:-------:|:------------------------------------------------------------------------------------|
|  VAR-d16   |  256  |   3.55   |    0.4    |  310M   | [var_d16.pth](https://huggingface.co/FoundationVision/var/resolve/main/var_d16.pth) |
|  VAR-d20   |  256  |   2.95   |    0.5    |  600M   | [var_d20.pth](https://huggingface.co/FoundationVision/var/resolve/main/var_d20.pth) |
|  VAR-d24   |  256  |   2.33   |    0.6    |  1.0B   | [var_d24.pth](https://huggingface.co/FoundationVision/var/resolve/main/var_d24.pth) |
|  VAR-d30   |  256  |   1.97   |     1     |  2.0B   | [var_d30.pth](https://huggingface.co/FoundationVision/var/resolve/main/var_d30.pth) |
| VAR-d30-re |  256  | **1.80** |     1     |  2.0B   | [var_d30.pth](https://huggingface.co/FoundationVision/var/resolve/main/var_d30.pth) |


![bench](bench.png)

ä¸‹é¢ä½¿ç”¨çš„æ˜¯VAR-d16ï¼Œç”Ÿæˆçš„å›¾åƒå‡ä¸º256*256åˆ†è¾¨ç‡ï¼Œç”Ÿæˆ4ç§8å¼ å›¾ç‰‡ï¼Œå‚æ•°å¦‚ä¸‹:   
```python
# set args
seed = random.randint(1, 1000) #@param {type:"number"}
torch.manual_seed(seed)
num_sampling_steps = 500 #@param {type:"slider", min:0, max:1000, step:1}
cfg = 8 #@param {type:"slider", min:1, max:10, step:0.1}
class_labels = (980, 980, 437, 437, 22, 22, 562, 562)  #@param {type:"raw"}
more_smooth = True # True for more smooth output
```

![time1](time1.jpg)
![time2](time2.jpg)
![result1](result1.png)
![result2](result2.png)

å¾—åˆ°çš„ç»“æœå¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¹³å‡ç”Ÿæˆä¸€å¼ å›¾ç‰‡åœ¨0.1så·¦å³ï¼Œè¿œè¿œå¿«äºæ‰©æ•£æ¨¡å‹....ææ€–å¦‚æ–¯ã€‚


### Outro
æœºå™¨å­¦ä¹ æ˜¯ç»Ÿè®¡å­¦ä¸Šçš„å¤§åŠ›å‡ºå¥‡è¿¹ã€‚  
æœ‰äº›æ—¶å€™ï¼Œæˆ‘æ„Ÿè§‰è¿™ç§å¥‡æ€å¦™çš„ç»“æ„æ›´å®¹æ˜“å‘ç”Ÿåœ¨ä¸€äº›ä¸æ˜¯å®Œå…¨ä¸“ä¸šçš„ç¾¤ä½“ï¼Œæˆ–è€…æ˜¯äº§ç”Ÿäºä¸€äº›ä¸åˆ‡å®é™…çš„BrainStormã€‚  
æœ‰è¿™ä¹ˆä¸€ä¸ªæ•…äº‹ï¼šå°±æ˜¯å¦‚ä½•èƒ½å¿«é€Ÿæ¸…ç†ç”µçº¿ä¸Šé¢å †ç§¯çš„é›ªå‘¢ï¼Œä¸€ä¸ªéå¸¸é«˜æ•ˆçš„æ–¹æ³•å°±æ¥æºäºä¸€ä¸ªå¾ˆä¸åˆ‡å®é™…çš„è¯è¯­â€”â€”â€”å¼€é£æœºé£åˆ°å¤©ä¸Šç”¨æ‰«å¸šæ¸…ç†å®ƒä»¬ã€‚è€Œè¢«é‡‡ç”¨çš„æ–¹æ³•æ­£æ˜¯é£æœºï¼Œä¸è¿‡æ²¡æœ‰æ‰«å¸šï¼Œç›´å‡æœºå¼•èµ·çš„æ°”æµè¶³ä»¥å¹å¹²å‡€å®ƒä»¬äº†ã€‚

å›å¤´æƒ³æƒ³æ‰©æ•£æ¨¡å‹å’Œè¿™ä¸ªæ”¾ç¼©æ¨¡å‹(VAR,æˆ‘è¿™ä¹ˆç§°å‘¼å®ƒ)ï¼Œå¥½åƒä¹Ÿæœ‰ä¸€ç§è¿™æ ·çš„æ„Ÿè§‰ï¼Œæ€è·¯æ¸…å¥‡ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œè¿™äº›ä½œè€…ä»–ä»¬æ˜¯ä¸“ä¸šäººå£«hhhhã€‚  
æˆ‘æœŸå¾…runtimeçš„AIæ¨¡å‹æ¨ç†åº”ç”¨åˆ°å„å¤„ã€‚è§†é¢‘ã€æ¸¸æˆã€å¥½åƒæˆ‘ä»¬ç¦»æ‘†è„±é•¿æ—¶é—´çš„æ¨ç†æ—¶é—´ä¸è¿œäº†ã€‚æ‹¥æŠ±æ— å»¶è¿Ÿçš„AIGCå¥½åƒå¾ˆå¿«ä¼šåˆ°æ¥ã€‚

ä¹Ÿè®¸å¾ˆå¿«å®ƒå°±ä¼šå–ä»£æ‰©æ•£æ¨¡å‹ï¼Œä¹Ÿè®¸ä¸ä¼šã€‚ä¹Ÿè®¸å®ƒå¾ˆå¿«å°±åˆä¼šè¢«å¦å¤–çš„æ¨¡å‹å–ä»£ã€‚   
ä¸è¿‡å‘¢ï¼Œæš´åŠ›å–ä¼˜å·²ç»æ˜¯äººå·¥æ™ºèƒ½é»˜è®¤çš„å…±è¯†åšæ³•äº†ï¼Œä¸è¿‡ï¼Œæ˜¯ä¸æ˜¯çœŸçš„ç§‘æŠ€æ ‘ç‚¹æ­ªäº†ï¼Œåœ¨ä¸€ä¸ªä¸æ˜¯é‚£ä¹ˆåˆç†çš„æ¶æ„ä¸Šç™»å³°é€ æï¼Œç­‰é‡åˆ°äº†å¦ä¸€ä¸ªæ›´ä¼˜çš„æ¨¡å‹ä¹Ÿè®¸ä¹Ÿä¸å†ä¼šçŸ«æ­£äº†ã€‚  
ä¸è¿‡åœ¨è¿™ä¸ªAIæŠ€æœ¯é‡è›®ç”Ÿé•¿çš„æ—¶ä»£ï¼Œä¼¼ä¹è¿…é€Ÿçš„æ·˜æ±°æ›´æ–°æ‰æ˜¯å¸¸æ€ã€‚  
